---
title: "lab1"
author: "Leticia Wanderley"
date: "19 de maio de 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("dplyr")
library("tidyr")
library("ggplot2")
library("readr")
```

## Problema 1 - Checkpoint 1

As séries escolhida foram: Modern Family, Sherlock, House of Cards e How I Met Your Mother.
Carregando o subconjunto de séries:
```{r series, include=FALSE}
dados = read_csv("series_from_imdb.csv")
series = dados %>% 
  filter(series_name %in% c("Modern Family", "Sherlock", "House of Cards", "How I Met Your Mother"))
```

### Respondendo às perguntas

#### a. Qual das séries que você escolheu é mais bem avaliada no IMDB? A diferença é grande? Pequena?

```{r boxplot}
series %>% 
  ggplot(aes(x = reorder(series_name, -UserRating, FUN=median), y = UserRating)) + theme_bw() +
  geom_boxplot(outlier.alpha = .2) +
  geom_point(data=(group_by(series, series_name) %>% summarise(UserRating=max(UserRating))), 
             aes(x=series_name, y=UserRating), colour="darkgreen", alpha=.8) +
  geom_point(data=(group_by(series, series_name) %>% summarise(UserRating=min(UserRating))), 
             aes(x=series_name, y=UserRating), colour="darkred", alpha=.8) +
  labs(x="Nome da série", y="Mediana das notas", title="Série mais bem avaliada")
```
```{r valores}
group_by(series, Série=series_name) %>% 
  summarize(Mediana=median(UserRating),Máximo=max(UserRating),Mínimo=min(UserRating),Média=mean(UserRating)) %>%
  arrange(desc(Mediana))
```

Usando quatro diferentes métricas para sumarizar as notas dadas pelos usuários o resultado é sempre o mesmo. Sherlock é a melhor série, seguida por House of Cards, How I Met Your Mother e Modern Family, nesss ordem.

#### b. Qual das séries que você escolheu tem episódios de qualidade mais irregular segundo o IMDB? A diferença é grande? Pequena?

```{r ratings}
series %>%
  ggplot(aes(x=series_ep, y=UserRating)) + 
  theme_bw() +
  geom_line() +
  facet_wrap(~series_name, scales="free")
```

``` {r split, include=FALSE}
split.series <- function(name) {
  series[series$series_name==name,]
} 

draw.season.ratings <- function(show) {
  show %>%
    ggplot(aes(x=season_ep, y=UserRating)) + 
    theme_bw() +
    geom_line() +
    facet_wrap(~season, scales="free") +
    labs(x="", y="", title="Notas dos usuários por episódio por temporada")
}

sherlock = split.series("Sherlock")
hoc = split.series("House of Cards")
himym = split.series("How I Met Your Mother")
mf = split.series("Modern Family")
```
##### Sherlock

```{r sherlock}
draw.season.ratings(sherlock)
```

##### House of Cards

```{r hoc}
draw.season.ratings(hoc)
```

##### Modern Family

```{r mf}
draw.season.ratings(mf)
```

##### How I Met You Mother

```{r himym}
draw.season.ratings(himym)
```

Variância

```{r}
group_by(series, Série=series_name) %>% 
  summarize(Variância = var(UserRating)) %>%
  arrange(Variância)
```