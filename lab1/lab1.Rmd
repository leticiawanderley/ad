---
title: "lab1"
author: "Leticia Wanderley"
date: "19 de maio de 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("dplyr")
library("tidyr")
library("ggplot2")
library("readr")
```

## Problema 1 - Checkpoint 1

```{r series, include=FALSE}
dados = read_csv("series_from_imdb.csv")
series = dados %>% 
  filter(series_name %in% c("Modern Family", "Sherlock", "House of Cards", "How I Met Your Mother"))
```
> As séries escolhidas foram: Modern Family, Sherlock, House of Cards e How I Met Your Mother.
__Modern Family__ e __How I Met Your Mother__ são séries americanas no estilo sitcom, produzidas respectivamente pelos canais ABC e CBS. Ambas tem uma quantidade relativamente grande de temporadas, 7 ou mais, com aproximadamente 20 episódios de 20 minutos de duração por temporada. 
Já __Sherlock__ e __House of Cards__ são séries de drama com quatro temporadas cada. Sherlock é produzida pelo canal britânico BBC tem 4 episódios de aproximadamente 1 hora por temporada e House of Cards é produzida, nos EUA, pelo serviço de streaming Netflix e conta com 13 episódios de aproximadamente 1 hora por temporada. 

### Respondendo às perguntas

#### a. Qual das séries que você escolheu é mais bem avaliada no IMDB? A diferença é grande? Pequena?

```{r boxplot}
series %>% 
  ggplot(aes(x = reorder(series_name, -UserRating, FUN=median), y = UserRating)) + theme_bw() +
  geom_boxplot(outlier.alpha = .2) +
  geom_point(data=(group_by(series, series_name) %>% summarise(UserRating=max(UserRating))), 
             aes(x=series_name, y=UserRating), colour="darkgreen", alpha=.8) +
  geom_point(data=(group_by(series, series_name) %>% summarise(UserRating=min(UserRating))), 
             aes(x=series_name, y=UserRating), colour="darkred", alpha=.8) +
  labs(x="Nome da série", y="Mediana das notas", title="Série mais bem avaliada")
```

> Nos boxplots acima se pode ver que a mediana e a nota máxima da série Sherlock são as maiores do conjunto analisado, seguidas por House of Cards e depois por How I Met Your Mother e Modern Family. Quando se observa a nota mínima tem se um resultado um pouco diferente, a série com a maior nota mínima é House of Cards, é essa, também, a série que tem a menor variação entre as notas atribuídas por episódio. Já How I Met Your Mother tem a menor nota mínima do conjunto e também a maior variação de notas.

> Analisando o __IQR__ é possível observar que as notas da série Modern Family se concentram em volta de sua mediana, 8. As notas da série House of Cards se concentram em volta de um intervalo de valores relativamente pequeno, entre 8.4 e 8.9. No caso de Sherlock e How I Met Your Mother as notas estão menos concentradas, o intervalo de valores onde se encontram 50% da notas é maior, entre 8.4 e 9.3 no caso de Sherlock e entre 7.9 e 8.6 no caso de How I Met Your Mother.

__IQR__ (Interquartile Range), diferença entre o terceiro e primeiro quartil das observações. é uma medida de dispersão que representam onde estão concentrados os 50% centrais dos dados. 

```{r values}
series %>%
  group_by(Série=series_name) %>% 
  summarize(Mediana=median(UserRating),Máximo=max(UserRating),Mínimo=min(UserRating),
            IQR=IQR(UserRating),Média=mean(UserRating)) %>%
  arrange(desc(Mediana))
```

> De acordo com a maior parte das métricas analisadas __Sherlock__ é a série mais bem avaliada do subconjunto escolhido. A diferença entre as métricas, no entanto, não varia drasticamente entre as séries. Variando dentro de um intervalo de 1 ponto no caso da mediana, nota máxima e média e por volta de 2 pontos no caso da nota mínima. O que se observa nesse subconjunto específico é que as séries de drama são melhor avaliadas quando comparadas com as de comédia. Outro fator que pode contribuir para esse resultado é o fato que as séries melhor avaliadas têm uma menor quantidade de episódios por temporada, é possível que, com menos episódios com os quais se preocupar, os produtores foquem mais na qualidade. 

#### b. Qual das séries que você escolheu tem episódios de qualidade mais irregular segundo o IMDB? A diferença é grande? Pequena?

```{r ratings}
series %>%
  ggplot(aes(x=series_ep, y=UserRating)) + 
  theme_bw() +
  geom_line() +
  facet_wrap(~series_name, scales="free")
```

``` {r split, include=FALSE}
split.series <- function(name) {
  series[series$series_name==name,]
} 

draw.season.ratings <- function(show) {
  show %>%
    ggplot(aes(x=season_ep, y=UserRating)) + 
    theme_bw() +
    geom_line() +
    facet_wrap(~season, scales="free") +
    labs(x="", y="", title="Notas dos usuários por episódio por temporada")
}

sherlock = split.series("Sherlock")
hoc = split.series("House of Cards")
himym = split.series("How I Met Your Mother")
mf = split.series("Modern Family")
```
##### Sherlock

```{r sherlock}
draw.season.ratings(sherlock)
```

##### House of Cards

```{r hoc}
draw.season.ratings(hoc)
```

##### Modern Family

```{r mf}
draw.season.ratings(mf)
```

##### How I Met You Mother

```{r himym}
draw.season.ratings(himym)
```

Variância

```{r}
group_by(series, Série=series_name) %>% 
  summarize(Variância = var(UserRating)) %>%
  arrange(Variância)
```